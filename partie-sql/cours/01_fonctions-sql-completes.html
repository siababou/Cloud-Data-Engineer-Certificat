<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fonctions SQL Complètes - Agrégation, Chaînes, Dates, Conditionnelles, Numériques et Avancées</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem auto;
    background-color: #f0f4ff;
    color: #1a237e;
    max-width: 900px;
    padding: 0 1rem;
  }
  h1, h2, h3 {
    color: #283593;
    margin-top: 2rem;
  }
  table {
    border-collapse: collapse;
    margin-bottom: 2rem;
    width: 100%;
    box-shadow: 0 0 8px rgba(40, 53, 147, 0.15);
  }
  th, td {
    border: 1px solid #9fa8da;
    padding: 0.5rem 1rem;
    text-align: left;
  }
  th {
    background-color: #283593;
    color: white;
  }
  pre {
    background: #c5cae9;
    border-left: 5px solid #283593;
    padding: 1rem;
    overflow-x: auto;
    font-family: Consolas, monospace;
    margin-bottom: 1rem;
    white-space: pre-wrap;
  }
  code {
    background: #c5cae9;
    padding: 2px 5px;
    border-radius: 4px;
    font-family: Consolas, monospace;
  }
  /* Style pour les petites tables exemple */
  .example-table th, .example-table td {
    text-align: center;
  }
  /* Style pour les tables de données exemple (avec colonnes séparées) */
  .data-table {
    margin-top: 0.5rem;
  }
  /* Table de structure simple avec une ligne */
  .structure-table td {
    font-family: monospace;
    background: #e8eaf6;
    border-color: #c5cae9;
  }
</style>
</head>
<body>

<h1>Fonctions SQL Complètes</h1>

<h2>1. Fonctions d’Agrégation</h2>

<table class="structure-table">
  <tbody>
    <tr><td><code>id</code></td><td><code>product</code></td><td><code>quantity</code></td><td><code>price</code></td></tr>
  </tbody>
</table>
<table class="data-table">
  <tbody>
    <tr><td>1</td><td>Livre</td><td>10</td><td>15.5</td></tr>
    <tr><td>2</td><td>Stylo</td><td>25</td><td>1.2</td></tr>
    <tr><td>3</td><td>Cahier</td><td>5</td><td>4.5</td></tr>
    <tr><td>4</td><td>Livre</td><td>7</td><td>15.5</td></tr>
  </tbody>
</table>

<h3><code>COUNT()</code> — Compter les lignes</h3>
<pre><code>SELECT COUNT(*) AS total_ventes FROM sales;</code></pre>
<table class="example-table">
  <tbody><tr><td>4</td></tr>
  </tbody>
</table>

<h3><code>SUM()</code> — Somme</h3>
<pre><code>SELECT SUM(quantity) AS total_articles_vendus FROM sales;</code></pre>
<table class="example-table">
  <tbody><tr><td>47</td></tr>
  </tbody>
</table>

<h3><code>AVG()</code> — Moyenne</h3>
<pre><code>SELECT AVG(price) AS prix_moyen FROM sales;</code></pre>
<table class="example-table">
  <tbody><tr><td>9.175</td></tr>
  </tbody>
</table>

<h3><code>MAX()</code> et <code>MIN()</code></h3>
<pre><code>SELECT MAX(price) AS prix_max, MIN(price) AS prix_min FROM sales;</code></pre>
<table class="example-table">
  <tbody><tr><td>15.5</td><td>1.2</td></tr>
  </tbody>
</table>

<hr>

<h2>2. Fonctions de Chaînes de Caractères</h2>

<table class="structure-table">
  <tbody>
    <tr><td><code>id</code></td><td><code>first_name</code></td><td><code>last_name</code></td></tr>
  </tbody>
</table>
<table class="data-table">
  <tbody>
    <tr><td>1</td><td>Jean</td><td>Dupont</td></tr>
    <tr><td>2</td><td>Marie</td><td>Curie</td></tr>
    <tr><td>3</td><td>Pierre</td><td>Martin</td></tr>
  </tbody>
</table>

<h3><code>CONCAT()</code></h3>
<pre><code>SELECT CONCAT(first_name, ' ', last_name) AS full_name FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>Jean Dupont</td></tr>
    <tr><td>Marie Curie</td></tr>
    <tr><td>Pierre Martin</td></tr>
  </tbody>
</table>

<h3><code>SUBSTRING()</code></h3>
<pre><code>SELECT SUBSTRING(first_name, 1, 3) AS first_three FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>Jea</td></tr>
    <tr><td>Mar</td></tr>
    <tr><td>Pie</td></tr>
  </tbody>
</table>

<h3><code>UPPER()</code> et <code>LOWER()</code></h3>
<pre><code>SELECT UPPER(first_name) AS prenom_maj, LOWER(last_name) AS nom_min FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>JEAN</td><td>dupont</td></tr>
    <tr><td>MARIE</td><td>curie</td></tr>
    <tr><td>PIERRE</td><td>martin</td></tr>
  </tbody>
</table>

<hr>

<h2>3. Fonctions de Dates</h2>

<h3><code>NOW()</code> et <code>CURRENT_DATE()</code></h3>
<pre><code>SELECT NOW() AS date_heure, CURRENT_DATE() AS date_jour;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>2025-05-20 10:15:00</td><td>2025-05-20</td></tr>
  </tbody>
</table>

<h3><code>YEAR()</code></h3>
<pre><code>SELECT YEAR('2023-12-31') AS annee;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>2023</td></tr>
  </tbody>
</table>

<h3><code>DATEDIFF()</code></h3>
<pre><code>SELECT DATEDIFF('2025-05-20', '2025-01-01') AS nb_jours;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>139</td></tr>
  </tbody>
</table>

<hr>

<h2>4. Fonctions Conditionnelles</h2>

<table class="structure-table">
  <tbody>
    <tr><td><code>id</code></td><td><code>first_name</code></td><td><code>salary</code></td><td><code>bonus</code></td></tr>
  </tbody>
</table>
<table class="data-table">
  <tbody>
    <tr><td>1</td><td>Jean</td><td>5000</td><td>NULL</td></tr>
    <tr><td>2</td><td>Marie</td><td>7000</td><td>500</td></tr>
    <tr><td>3</td><td>Pierre</td><td>4000</td><td>NULL</td></tr>
  </tbody>
</table>

<h3><code>CASE</code></h3>
<pre><code>SELECT first_name, salary,
  CASE
    WHEN salary &gt;= 6000 THEN 'Haut'
    WHEN salary &gt;= 4000 THEN 'Moyen'
    ELSE 'Bas'
  END AS categorie_salaire
FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>Jean</td><td>5000</td><td>Moyen</td></tr>
    <tr><td>Marie</td><td>7000</td><td>Haut</td></tr>
    <tr><td>Pierre</td><td>4000</td><td>Moyen</td></tr>
  </tbody>
</table>

<h3><code>IF()</code></h3>
<pre><code>SELECT first_name,
       IF(salary &gt; 6000, 'Bonus', 'Pas de bonus') AS bonus_status
FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>Jean</td><td>Pas de bonus</td></tr>
    <tr><td>Marie</td><td>Bonus</td></tr>
    <tr><td>Pierre</td><td>Pas de bonus</td></tr>
  </tbody>
</table>

<h3><code>COALESCE()</code></h3>
<pre><code>SELECT first_name, bonus, COALESCE(bonus, 0) AS bonus_corrige FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>Jean</td><td>NULL</td><td>0</td></tr>
    <tr><td>Marie</td><td>500</td><td>500</td></tr>
    <tr><td>Pierre</td><td>NULL</td><td>0</td></tr>
  </tbody>
</table>

<hr>

<h2>5. Fonctions Numériques</h2>

<h3><code>ROUND()</code></h3>
<pre><code>SELECT ROUND(123.4567, 2) AS arrondi;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>123.46</td></tr>
  </tbody>
</table>

<h3><code>FLOOR()</code> et <code>CEIL()</code></h3>
<pre><code>SELECT FLOOR(123.99) AS vers_bas, CEIL(123.01) AS vers_haut;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>123</td><td>124</td></tr>
  </tbody>
</table>

<h3><code>ABS()</code></h3>
<pre><code>SELECT ABS(-123) AS valeur_absolue;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>123</td></tr>
  </tbody>
</table>

<hr>

<h2>6. Fonctions Avancées</h2>

<h3><code>CAST()</code> et <code>CONVERT()</code></h3>
<pre><code>SELECT CAST(salary AS CHAR) AS salaire_texte FROM employees;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>5000</td></tr>
    <tr><td>7000</td></tr>
    <tr><td>4000</td></tr>
  </tbody>
</table>

<h3><code>JSON_EXTRACT()</code> (MySQL spécifique)</h3>
<pre><code>SELECT JSON_EXTRACT('{"nom":"Jean","age":30}', '$.nom') AS nom;</code></pre>
<table class="example-table">
  <tbody>
    <tr><td>"Jean"</td></tr>
  </tbody>
</table>

<hr>

<h2>Résumé des Fonctions SQL</h2>

<table>
  <thead>
    <tr>
      <th>Fonction</th>
      <th>Catégorie</th>
      <th>Description</th>
      <th>Exemple</th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>COUNT()</code></td><td>Agrégation</td><td>Compte les lignes</td><td>Nombre total</td></tr>
    <tr><td><code>SUM()</code></td><td>Agrégation</td><td>Somme des valeurs</td><td>Total quantité</td></tr>
    <tr><td><code>AVG()</code></td><td>Agrégation</td><td>Moyenne des valeurs</td><td>Prix moyen</td></tr>
    <tr><td><code>MAX()</code>, <code>MIN()</code></td><td>Agrégation</td><td>Valeur max/min</td><td>Prix max/min</td></tr>
    <tr><td><code>CONCAT()</code></td><td>Chaînes</td><td>Concatène plusieurs chaînes</td><td>Prénom + nom</td></tr>
    <tr><td><code>SUBSTRING()</code></td><td>Chaînes</td><td>Extrait sous-chaîne</td><td>3 premières lettres prénom</td></tr>
    <tr><td><code>UPPER()</code>, <code>LOWER()</code></td><td>Chaînes</td><td>Majuscules / minuscules</td><td>Nom en minuscules</td></tr>
    <tr><td><code>NOW()</code>, <code>CURRENT_DATE()</code></td><td>Dates</td><td>Date/heure courantes</td><td>Date du jour</td></tr>
    <tr><td><code>YEAR()</code></td><td>Dates</td><td>Extrait l’année</td><td>Année d’une date</td></tr>
    <tr><td><code>DATEDIFF()</code></td><td>Dates</td><td>Différence entre 2 dates</td><td>Nombre jours</td></tr>
    <tr><td><code>CASE</code></td><td>Conditionnelles</td><td>Conditions multiples</td><td>Catégorie salaire</td></tr>
    <tr><td><code>IF()</code></td><td>Conditionnelles</td><td>Condition simple</td><td>Bonus selon salaire</td></tr>
    <tr><td><code>COALESCE()</code></td><td>Conditionnelles</td><td>Remplace NULL</td><td>Valeur par défaut</td></tr>
    <tr><td><code>ROUND()</code></td><td>Numériques</td><td>Arrondit nombre</td><td>Arrondi décimal</td></tr>
    <tr><td><code>FLOOR()</code>, <code>CEIL()</code></td><td>Numériques</td><td>Partie entière bas/haut</td><td>Arrondi inférieur/supérieur</td></tr>
    <tr><td><code>ABS()</code></td><td>Numériques</td><td>Valeur absolue</td><td>Valeur positive</td></tr>
    <tr><td><code>CAST()</code>, <code>CONVERT()</code></td><td>Avancées</td><td>Conversion de type</td><td>Nombre → texte</td></tr>
    <tr><td><code>JSON_EXTRACT()</code></td><td>Avancées</td><td>Extraction JSON</td><td>Valeur JSON</td></tr>
  </tbody>
</table>

<section>
    <button type="submit" class="submit-btn"> <a href="/Cloud-Data-Engineer-Certificat/sommaire.html">← Retour à l'accueil</a></button>
    <button type="submit" class="submit-btn"> <a  href="02_fonctions_analytiques_sql.html">Partie suivante →</a></button>
    <button type="submit" class="submit-btn"> <a  href="/Cloud-Data-Engineer-Certificat/partie-sql/quiz/quiz-sql-1.html">Question → </a></button>
  </section>
  
</body>
</html>
